(function(S,k){typeof exports=="object"&&typeof module!="undefined"?k(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],k):(S=typeof globalThis!="undefined"?globalThis:S||self,k(S["v-network-graph"]={},S.Vue))})(this,function(S,k){"use strict";function J(t,n){var e,r=1;t==null&&(t=0),n==null&&(n=0);function i(){var o,l=e.length,f,h=0,a=0;for(o=0;o<l;++o)f=e[o],h+=f.x,a+=f.y;for(h=(h/l-t)*r,a=(a/l-n)*r,o=0;o<l;++o)f=e[o],f.x-=h,f.y-=a}return i.initialize=function(o){e=o},i.x=function(o){return arguments.length?(t=+o,i):t},i.y=function(o){return arguments.length?(n=+o,i):n},i.strength=function(o){return arguments.length?(r=+o,i):r},i}function gt(t){const n=+this._x.call(null,t),e=+this._y.call(null,t);return U(this.cover(n,e),n,e,t)}function U(t,n,e,r){if(isNaN(n)||isNaN(e))return t;var i,o=t._root,l={data:r},f=t._x0,h=t._y0,a=t._x1,g=t._y1,_,x,v,d,s,u,c,y;if(!o)return t._root=l,t;for(;o.length;)if((s=n>=(_=(f+a)/2))?f=_:a=_,(u=e>=(x=(h+g)/2))?h=x:g=x,i=o,!(o=o[c=u<<1|s]))return i[c]=l,t;if(v=+t._x.call(null,o.data),d=+t._y.call(null,o.data),n===v&&e===d)return l.next=o,i?i[c]=l:t._root=l,t;do i=i?i[c]=new Array(4):t._root=new Array(4),(s=n>=(_=(f+a)/2))?f=_:a=_,(u=e>=(x=(h+g)/2))?h=x:g=x;while((c=u<<1|s)===(y=(d>=x)<<1|v>=_));return i[y]=o,i[c]=l,t}function pt(t){var n,e,r=t.length,i,o,l=new Array(r),f=new Array(r),h=1/0,a=1/0,g=-1/0,_=-1/0;for(e=0;e<r;++e)isNaN(i=+this._x.call(null,n=t[e]))||isNaN(o=+this._y.call(null,n))||(l[e]=i,f[e]=o,i<h&&(h=i),i>g&&(g=i),o<a&&(a=o),o>_&&(_=o));if(h>g||a>_)return this;for(this.cover(h,a).cover(g,_),e=0;e<r;++e)U(this,l[e],f[e],t[e]);return this}function xt(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var e=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(e))i=(e=Math.floor(t))+1,o=(r=Math.floor(n))+1;else{for(var l=i-e||1,f=this._root,h,a;e>t||t>=i||r>n||n>=o;)switch(a=(n<r)<<1|t<e,h=new Array(4),h[a]=f,f=h,l*=2,a){case 0:i=e+l,o=r+l;break;case 1:e=i-l,o=r+l;break;case 2:i=e+l,r=o-l;break;case 3:e=i-l,r=o-l;break}this._root&&this._root.length&&(this._root=f)}return this._x0=e,this._y0=r,this._x1=i,this._y1=o,this}function dt(){var t=[];return this.visit(function(n){if(!n.length)do t.push(n.data);while(n=n.next)}),t}function _t(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function b(t,n,e,r,i){this.node=t,this.x0=n,this.y0=e,this.x1=r,this.y1=i}function wt(t,n,e){var r,i=this._x0,o=this._y0,l,f,h,a,g=this._x1,_=this._y1,x=[],v=this._root,d,s;for(v&&x.push(new b(v,i,o,g,_)),e==null?e=1/0:(i=t-e,o=n-e,g=t+e,_=n+e,e*=e);d=x.pop();)if(!(!(v=d.node)||(l=d.x0)>g||(f=d.y0)>_||(h=d.x1)<i||(a=d.y1)<o))if(v.length){var u=(l+h)/2,c=(f+a)/2;x.push(new b(v[3],u,c,h,a),new b(v[2],l,c,u,a),new b(v[1],u,f,h,c),new b(v[0],l,f,u,c)),(s=(n>=c)<<1|t>=u)&&(d=x[x.length-1],x[x.length-1]=x[x.length-1-s],x[x.length-1-s]=d)}else{var y=t-+this._x.call(null,v.data),w=n-+this._y.call(null,v.data),p=y*y+w*w;if(p<e){var m=Math.sqrt(e=p);i=t-m,o=n-m,g=t+m,_=n+m,r=v.data}}return r}function mt(t){if(isNaN(g=+this._x.call(null,t))||isNaN(_=+this._y.call(null,t)))return this;var n,e=this._root,r,i,o,l=this._x0,f=this._y0,h=this._x1,a=this._y1,g,_,x,v,d,s,u,c;if(!e)return this;if(e.length)for(;;){if((d=g>=(x=(l+h)/2))?l=x:h=x,(s=_>=(v=(f+a)/2))?f=v:a=v,n=e,!(e=e[u=s<<1|d]))return this;if(!e.length)break;(n[u+1&3]||n[u+2&3]||n[u+3&3])&&(r=n,c=u)}for(;e.data!==t;)if(i=e,!(e=e.next))return this;return(o=e.next)&&delete e.next,i?(o?i.next=o:delete i.next,this):n?(o?n[u]=o:delete n[u],(e=n[0]||n[1]||n[2]||n[3])&&e===(n[3]||n[2]||n[1]||n[0])&&!e.length&&(r?r[c]=e:this._root=e),this):(this._root=o,this)}function Nt(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this}function At(){return this._root}function Mt(){var t=0;return this.visit(function(n){if(!n.length)do++t;while(n=n.next)}),t}function bt(t){var n=[],e,r=this._root,i,o,l,f,h;for(r&&n.push(new b(r,this._x0,this._y0,this._x1,this._y1));e=n.pop();)if(!t(r=e.node,o=e.x0,l=e.y0,f=e.x1,h=e.y1)&&r.length){var a=(o+f)/2,g=(l+h)/2;(i=r[3])&&n.push(new b(i,a,g,f,h)),(i=r[2])&&n.push(new b(i,o,g,a,h)),(i=r[1])&&n.push(new b(i,a,l,f,g)),(i=r[0])&&n.push(new b(i,o,l,a,g))}return this}function Ot(t){var n=[],e=[],r;for(this._root&&n.push(new b(this._root,this._x0,this._y0,this._x1,this._y1));r=n.pop();){var i=r.node;if(i.length){var o,l=r.x0,f=r.y0,h=r.x1,a=r.y1,g=(l+h)/2,_=(f+a)/2;(o=i[0])&&n.push(new b(o,l,f,g,_)),(o=i[1])&&n.push(new b(o,g,f,h,_)),(o=i[2])&&n.push(new b(o,l,_,g,a)),(o=i[3])&&n.push(new b(o,g,_,h,a))}e.push(r)}for(;r=e.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function jt(t){return t[0]}function Pt(t){return arguments.length?(this._x=t,this):this._x}function Lt(t){return t[1]}function zt(t){return arguments.length?(this._y=t,this):this._y}function X(t,n,e){var r=new Y(n==null?jt:n,e==null?Lt:e,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function Y(t,n,e,r,i,o){this._x=t,this._y=n,this._x0=e,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function q(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}var O=X.prototype=Y.prototype;O.copy=function(){var t=new Y(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root,e,r;if(!n)return t;if(!n.length)return t._root=q(n),t;for(e=[{source:n,target:t._root=new Array(4)}];n=e.pop();)for(var i=0;i<4;++i)(r=n.source[i])&&(r.length?e.push({source:r,target:n.target[i]=new Array(4)}):n.target[i]=q(r));return t},O.add=gt,O.addAll=pt,O.cover=xt,O.data=dt,O.extent=_t,O.find=wt,O.remove=mt,O.removeAll=Nt,O.root=At,O.size=Mt,O.visit=bt,O.visitAfter=Ot,O.x=Pt,O.y=zt;function N(t){return function(){return t}}function E(t){return(t()-.5)*1e-6}function Et(t){return t.x+t.vx}function Dt(t){return t.y+t.vy}function tt(t){var n,e,r,i=1,o=1;typeof t!="function"&&(t=N(t==null?1:+t));function l(){for(var a,g=n.length,_,x,v,d,s,u,c=0;c<o;++c)for(_=X(n,Et,Dt).visitAfter(f),a=0;a<g;++a)x=n[a],s=e[x.index],u=s*s,v=x.x+x.vx,d=x.y+x.vy,_.visit(y);function y(w,p,m,j,P){var A=w.data,L=w.r,M=s+L;if(A){if(A.index>x.index){var D=v-A.x-A.vx,I=d-A.y-A.vy,z=D*D+I*I;z<M*M&&(D===0&&(D=E(r),z+=D*D),I===0&&(I=E(r),z+=I*I),z=(M-(z=Math.sqrt(z)))/z*i,x.vx+=(D*=z)*(M=(L*=L)/(u+L)),x.vy+=(I*=z)*M,A.vx-=D*(M=1-M),A.vy-=I*M)}return}return p>v+M||j<v-M||m>d+M||P<d-M}}function f(a){if(a.data)return a.r=e[a.data.index];for(var g=a.r=0;g<4;++g)a[g]&&a[g].r>a.r&&(a.r=a[g].r)}function h(){if(!!n){var a,g=n.length,_;for(e=new Array(g),a=0;a<g;++a)_=n[a],e[_.index]=+t(_,a,n)}}return l.initialize=function(a,g){n=a,r=g,h()},l.iterations=function(a){return arguments.length?(o=+a,l):o},l.strength=function(a){return arguments.length?(i=+a,l):i},l.radius=function(a){return arguments.length?(t=typeof a=="function"?a:N(+a),h(),l):t},l}function It(t){return t.index}function nt(t,n){var e=t.get(n);if(!e)throw new Error("node not found: "+n);return e}function et(t){var n=It,e=_,r,i=N(30),o,l,f,h,a,g=1;t==null&&(t=[]);function _(u){return 1/Math.min(f[u.source.index],f[u.target.index])}function x(u){for(var c=0,y=t.length;c<g;++c)for(var w=0,p,m,j,P,A,L,M;w<y;++w)p=t[w],m=p.source,j=p.target,P=j.x+j.vx-m.x-m.vx||E(a),A=j.y+j.vy-m.y-m.vy||E(a),L=Math.sqrt(P*P+A*A),L=(L-o[w])/L*u*r[w],P*=L,A*=L,j.vx-=P*(M=h[w]),j.vy-=A*M,m.vx+=P*(M=1-M),m.vy+=A*M}function v(){if(!!l){var u,c=l.length,y=t.length,w=new Map(l.map((m,j)=>[n(m,j,l),m])),p;for(u=0,f=new Array(c);u<y;++u)p=t[u],p.index=u,typeof p.source!="object"&&(p.source=nt(w,p.source)),typeof p.target!="object"&&(p.target=nt(w,p.target)),f[p.source.index]=(f[p.source.index]||0)+1,f[p.target.index]=(f[p.target.index]||0)+1;for(u=0,h=new Array(y);u<y;++u)p=t[u],h[u]=f[p.source.index]/(f[p.source.index]+f[p.target.index]);r=new Array(y),d(),o=new Array(y),s()}}function d(){if(!!l)for(var u=0,c=t.length;u<c;++u)r[u]=+e(t[u],u,t)}function s(){if(!!l)for(var u=0,c=t.length;u<c;++u)o[u]=+i(t[u],u,t)}return x.initialize=function(u,c){l=u,a=c,v()},x.links=function(u){return arguments.length?(t=u,v(),x):t},x.id=function(u){return arguments.length?(n=u,x):n},x.iterations=function(u){return arguments.length?(g=+u,x):g},x.strength=function(u){return arguments.length?(e=typeof u=="function"?u:N(+u),d(),x):e},x.distance=function(u){return arguments.length?(i=typeof u=="function"?u:N(+u),s(),x):i},x}var St={value:()=>{}};function rt(){for(var t=0,n=arguments.length,e={},r;t<n;++t){if(!(r=arguments[t]+"")||r in e||/[\s.]/.test(r))throw new Error("illegal type: "+r);e[r]=[]}return new V(e)}function V(t){this._=t}function Tt(t,n){return t.trim().split(/^|\s+/).map(function(e){var r="",i=e.indexOf(".");if(i>=0&&(r=e.slice(i+1),e=e.slice(0,i)),e&&!n.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:r}})}V.prototype=rt.prototype={constructor:V,on:function(t,n){var e=this._,r=Tt(t+"",e),i,o=-1,l=r.length;if(arguments.length<2){for(;++o<l;)if((i=(t=r[o]).type)&&(i=kt(e[i],t.name)))return i;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++o<l;)if(i=(t=r[o]).type)e[i]=it(e[i],t.name,n);else if(n==null)for(i in e)e[i]=it(e[i],t.name,null);return this},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new V(t)},call:function(t,n){if((i=arguments.length-2)>0)for(var e=new Array(i),r=0,i,o;r<i;++r)e[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(n,e)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(n,e)}};function kt(t,n){for(var e=0,r=t.length,i;e<r;++e)if((i=t[e]).name===n)return i.value}function it(t,n,e){for(var r=0,i=t.length;r<i;++r)if(t[r].name===n){t[r]=St,t=t.slice(0,r).concat(t.slice(r+1));break}return e!=null&&t.push({name:n,value:e}),t}var F=0,$=0,B=0,ot=1e3,K,C,Q=0,T=0,W=0,R=typeof performance=="object"&&performance.now?performance:Date,ft=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function at(){return T||(ft(Ft),T=R.now()+W)}function Ft(){T=0}function H(){this._call=this._time=this._next=null}H.prototype=ut.prototype={constructor:H,restart:function(t,n,e){if(typeof t!="function")throw new TypeError("callback is not a function");e=(e==null?at():+e)+(n==null?0:+n),!this._next&&C!==this&&(C?C._next=this:K=this,C=this),this._call=t,this._time=e,Z()},stop:function(){this._call&&(this._call=null,this._time=1/0,Z())}};function ut(t,n,e){var r=new H;return r.restart(t,n,e),r}function $t(){at(),++F;for(var t=K,n;t;)(n=T-t._time)>=0&&t._call.call(void 0,n),t=t._next;--F}function st(){T=(Q=R.now())+W,F=$=0;try{$t()}finally{F=0,Ct(),T=0}}function Bt(){var t=R.now(),n=t-Q;n>ot&&(W-=n,Q=t)}function Ct(){for(var t,n=K,e,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:K=e);C=t,Z(r)}function Z(t){if(!F){$&&($=clearTimeout($));var n=t-T;n>24?(t<1/0&&($=setTimeout(st,t-R.now()-W)),B&&(B=clearInterval(B))):(B||(Q=R.now(),B=setInterval(Bt,ot)),F=1,ft(st))}}const Rt=1664525,Vt=1013904223,lt=4294967296;function Kt(){let t=1;return()=>(t=(Rt*t+Vt)%lt)/lt}function Qt(t){return t.x}function Wt(t){return t.y}var Xt=10,Yt=Math.PI*(3-Math.sqrt(5));function ct(t){var n,e=1,r=.001,i=1-Math.pow(r,1/300),o=0,l=.6,f=new Map,h=ut(_),a=rt("tick","end"),g=Kt();t==null&&(t=[]);function _(){x(),a.call("tick",n),e<r&&(h.stop(),a.call("end",n))}function x(s){var u,c=t.length,y;s===void 0&&(s=1);for(var w=0;w<s;++w)for(e+=(o-e)*i,f.forEach(function(p){p(e)}),u=0;u<c;++u)y=t[u],y.fx==null?y.x+=y.vx*=l:(y.x=y.fx,y.vx=0),y.fy==null?y.y+=y.vy*=l:(y.y=y.fy,y.vy=0);return n}function v(){for(var s=0,u=t.length,c;s<u;++s){if(c=t[s],c.index=s,c.fx!=null&&(c.x=c.fx),c.fy!=null&&(c.y=c.fy),isNaN(c.x)||isNaN(c.y)){var y=Xt*Math.sqrt(.5+s),w=s*Yt;c.x=y*Math.cos(w),c.y=y*Math.sin(w)}(isNaN(c.vx)||isNaN(c.vy))&&(c.vx=c.vy=0)}}function d(s){return s.initialize&&s.initialize(t,g),s}return v(),n={tick:x,restart:function(){return h.restart(_),n},stop:function(){return h.stop(),n},nodes:function(s){return arguments.length?(t=s,v(),f.forEach(d),n):t},alpha:function(s){return arguments.length?(e=+s,n):e},alphaMin:function(s){return arguments.length?(r=+s,n):r},alphaDecay:function(s){return arguments.length?(i=+s,n):+i},alphaTarget:function(s){return arguments.length?(o=+s,n):o},velocityDecay:function(s){return arguments.length?(l=1-s,n):1-l},randomSource:function(s){return arguments.length?(g=s,f.forEach(d),n):g},force:function(s,u){return arguments.length>1?(u==null?f.delete(s):f.set(s,d(u)),n):f.get(s)},find:function(s,u,c){var y=0,w=t.length,p,m,j,P,A;for(c==null?c=1/0:c*=c,y=0;y<w;++y)P=t[y],p=s-P.x,m=u-P.y,j=p*p+m*m,j<c&&(A=P,c=j);return A},on:function(s,u){return arguments.length>1?(a.on(s,u),n):a.on(s)}}}function ht(){var t,n,e,r,i=N(-30),o,l=1,f=1/0,h=.81;function a(v){var d,s=t.length,u=X(t,Qt,Wt).visitAfter(_);for(r=v,d=0;d<s;++d)n=t[d],u.visit(x)}function g(){if(!!t){var v,d=t.length,s;for(o=new Array(d),v=0;v<d;++v)s=t[v],o[s.index]=+i(s,v,t)}}function _(v){var d=0,s,u,c=0,y,w,p;if(v.length){for(y=w=p=0;p<4;++p)(s=v[p])&&(u=Math.abs(s.value))&&(d+=s.value,c+=u,y+=u*s.x,w+=u*s.y);v.x=y/c,v.y=w/c}else{s=v,s.x=s.data.x,s.y=s.data.y;do d+=o[s.data.index];while(s=s.next)}v.value=d}function x(v,d,s,u){if(!v.value)return!0;var c=v.x-n.x,y=v.y-n.y,w=u-d,p=c*c+y*y;if(w*w/h<p)return p<f&&(c===0&&(c=E(e),p+=c*c),y===0&&(y=E(e),p+=y*y),p<l&&(p=Math.sqrt(l*p)),n.vx+=c*v.value*r/p,n.vy+=y*v.value*r/p),!0;if(v.length||p>=f)return;(v.data!==n||v.next)&&(c===0&&(c=E(e),p+=c*c),y===0&&(y=E(e),p+=y*y),p<l&&(p=Math.sqrt(l*p)));do v.data!==n&&(w=o[v.data.index]*r/p,n.vx+=c*w,n.vy+=y*w);while(v=v.next)}return a.initialize=function(v,d){t=v,e=d,g()},a.strength=function(v){return arguments.length?(i=typeof v=="function"?v:N(+v),g(),a):i},a.distanceMin=function(v){return arguments.length?(l=v*v,a):Math.sqrt(l)},a.distanceMax=function(v){return arguments.length?(f=v*v,a):Math.sqrt(f)},a.theta=function(v){return arguments.length?(h=v*v,a):Math.sqrt(h)},a}function Ht(t,n,e){var r,i=N(.1),o,l;typeof t!="function"&&(t=N(+t)),n==null&&(n=0),e==null&&(e=0);function f(a){for(var g=0,_=r.length;g<_;++g){var x=r[g],v=x.x-n||1e-6,d=x.y-e||1e-6,s=Math.sqrt(v*v+d*d),u=(l[g]-s)*o[g]*a/s;x.vx+=v*u,x.vy+=d*u}}function h(){if(!!r){var a,g=r.length;for(o=new Array(g),l=new Array(g),a=0;a<g;++a)l[a]=+t(r[a],a,r),o[a]=isNaN(l[a])?0:+i(r[a],a,r)}}return f.initialize=function(a){r=a,h()},f.strength=function(a){return arguments.length?(i=typeof a=="function"?a:N(+a),h(),f):i},f.radius=function(a){return arguments.length?(t=typeof a=="function"?a:N(+a),h(),f):t},f.x=function(a){return arguments.length?(n=+a,f):n},f.y=function(a){return arguments.length?(e=+a,f):e},f}function Zt(t){var n=N(.1),e,r,i;typeof t!="function"&&(t=N(t==null?0:+t));function o(f){for(var h=0,a=e.length,g;h<a;++h)g=e[h],g.vx+=(i[h]-g.x)*r[h]*f}function l(){if(!!e){var f,h=e.length;for(r=new Array(h),i=new Array(h),f=0;f<h;++f)r[f]=isNaN(i[f]=+t(e[f],f,e))?0:+n(e[f],f,e)}}return o.initialize=function(f){e=f,l()},o.strength=function(f){return arguments.length?(n=typeof f=="function"?f:N(+f),l(),o):n},o.x=function(f){return arguments.length?(t=typeof f=="function"?f:N(+f),l(),o):t},o}function Gt(t){var n=N(.1),e,r,i;typeof t!="function"&&(t=N(t==null?0:+t));function o(f){for(var h=0,a=e.length,g;h<a;++h)g=e[h],g.vy+=(i[h]-g.y)*r[h]*f}function l(){if(!!e){var f,h=e.length;for(r=new Array(h),i=new Array(h),f=0;f<h;++f)r[f]=isNaN(i[f]=+t(e[f],f,e))?0:+n(e[f],f,e)}}return o.initialize=function(f){e=f,l()},o.strength=function(f){return arguments.length?(n=typeof f=="function"?f:N(+f),l(),o):n},o.y=function(f){return arguments.length?(t=typeof f=="function"?f:N(+f),l(),o):t},o}const Jt=Object.freeze(Object.defineProperty({__proto__:null,forceCenter:J,forceCollide:tt,forceLink:et,forceManyBody:ht,forceRadial:Ht,forceSimulation:ct,forceX:Zt,forceY:Gt},Symbol.toStringTag,{value:"Module"}));var Ut=Object.defineProperty,qt=Object.defineProperties,tn=Object.getOwnPropertyDescriptors,yt=Object.getOwnPropertySymbols,nn=Object.prototype.hasOwnProperty,en=Object.prototype.propertyIsEnumerable,vt=(t,n,e)=>n in t?Ut(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e,G=(t,n)=>{for(var e in n||(n={}))nn.call(n,e)&&vt(t,e,n[e]);if(yt)for(var e of yt(n))en.call(n,e)&&vt(t,e,n[e]);return t},rn=(t,n)=>qt(t,tn(n));class on{constructor(n={}){this.options=n}activate(n){const{nodePositions:e,nodes:r,edges:i,emitter:o,svgPanZoom:l}=n;let{nodeLayouts:f,nodeLayoutMap:h}=this.buildNodeLayouts(r.value,e,{x:0,y:0});const a=this.createSimulation(f,this.forceLayoutEdges(i.value,r.value));a.on("tick",()=>{var s,u,c;for(const y of f){const w=(s=e.value)==null?void 0:s[y.id];w&&(w.x=(u=y.x)!=null?u:0,w.y=(c=y.y)!=null?c:0)}});const g=()=>{a.alpha(.1).restart()},_=s=>{for(const[u,c]of Object.entries(s)){const y=h[u];y.fx=c.x,y.fy=c.y}g()},x=s=>{var u;for(const[c,y]of Object.entries(s)){const w=this.getNodeLayout(e,c),p=(u=h==null?void 0:h[c])!=null?u:{x:0,y:0};w.value.fixed||this.options.positionFixedByDrag?(p.fx=y.x,p.fy=y.y,w.value.fixed=!0):(p.x=y.x,p.y=y.y,delete p.fx,delete p.fy)}g()},v=({node:s,event:u})=>{if(this.options.positionFixedByClickWithAltKey&&u.altKey){const c=this.getNodeLayout(e,s);let y=h==null?void 0:h[s];y||(y={id:s,x:0,y:0},h[s]=y),c.value.fixed?(delete c.value.fixed,y.x=y.fx||y.x,y.y=y.fy||y.y,delete y.fx,delete y.fy):(c.value.fixed=!0,y.fx=y.x,y.fy=y.y),g()}},d=k.watch(()=>[Object.keys(r.value),Object.values(i.value).map(s=>`${s.source}=${s.target}`)],()=>{const s=l.getViewArea();({nodeLayouts:f,nodeLayoutMap:h}=this.buildNodeLayouts(r.value,e,s.center)),a.nodes(f);const u=a.force("edge");u&&u.links(this.forceLayoutEdges(i.value,r.value)),g()});o.on("node:dragstart",_),o.on("node:pointermove",_),o.on("node:dragend",x),o.on("node:click",v),this.onDeactivate=()=>{a.stop(),d(),o.off("node:dragstart",_),o.off("node:pointermove",_),o.off("node:dragend",x),o.off("node:click",v)}}deactivate(){this.onDeactivate&&this.onDeactivate()}createSimulation(n,e){if(this.options.createSimulation)return this.options.createSimulation(Jt,n,e);{const r=et(e).id(i=>i.id);return ct(n).force("edge",r.distance(100)).force("charge",ht()).force("collide",tt(50).strength(.2)).force("center",J().strength(.05)).alphaMin(.001)}}buildNodeLayouts(n,e,r){const i=Object.keys(n).filter(f=>!(f in e.value));for(const f of i)e.value[f]=G({},r);const o=this.forceNodeLayouts(e.value),l=Object.fromEntries(o.map(f=>[f.id,f]));return{nodeLayouts:o,nodeLayoutMap:l}}forceNodeLayouts(n){return Object.entries(n).map(([e,r])=>r.fixed?rn(G({id:e},r),{fx:r.x,fy:r.y}):G({id:e},r))}forceLayoutEdges(n,e){return Object.values(n).filter(r=>r.source in e&&r.target in e).map(r=>({source:r.source,target:r.target}))}getNodeLayout(n,e){const r=k.toRef(n.value,e);return r.value||(r.value={x:0,y:0}),r}}S.ForceLayout=on,Object.defineProperties(S,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=force-layout.js.map
